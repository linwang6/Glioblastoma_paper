#We use seurat 3.0 package to perform dimensional reduction
#Please check the seurat here https://satijalab.org/seurat/v3.0/pbmc3k_tutorial.html
#Created date, 08/06/2019
#For each case, we do 
#
#
glioma<-read.table('patient_gene_matrix',row.names=1,head=TRUE)
glioma<-CreateSeuratObject(counts = glioma, min.cells = 10, min.features = 200)
glioma[["percent.mt"]] <- PercentageFeatureSet(glioma, pattern = "^MT-")
VlnPlot(glioma, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
glioma[["percent.rp"]] <- PercentageFeatureSet(glioma, pattern = "^RP")
all.genes <- rownames(glioma)
glioma <- NormalizeData(glioma, normalization.method = "LogNormalize", scale.factor = 10000)
glioma <- FindVariableFeatures(glioma, selection.method = "vst", nfeatures = 1000)
#glioma <- SCTransform(object = glioma,vars.to.regress = c("percent.mt"))
glioma <- ScaleData(object = glioma,vars.to.regress = c("percent.mt"))
glioma <- RunPCA(glioma, features = VariableFeatures(object = glioma))
DimPlot(glioma, reduction = "pca",dims = c(1, 2),label = T)
glioma <- FindNeighbors(glioma, dims = 1:10)
glioma <- FindClusters(glioma, resolution = 0.5)
glioma <- RunUMAP(glioma, dims = 1:10)
glioma <- RunTSNE(glioma, dims = 1:10)


#
#

